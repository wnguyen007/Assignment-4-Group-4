---
title: "Untitled"
output:
  html_document:
    df_print: paged
keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE)
```



```{r Loading dataset,echo = FALSE}
dat = read.csv("Data/IMDb movies.csv")
```

```{r,echo = FALSE}
library(tidyverse)
library(treemap)
library(bookdown)
library(knitr)
```

# Language

## The proportion of top 100 movie language

```{r language,echo=FALSE,fig.cap="The proportion of top 100 movie language",warning=FALSE}
top100 <- head(names(sort(table(dat$language),decreasing = TRUE)),100) 
most_language <- dat %>% 
    filter(language %in% top100) %>% 
    group_by(language) %>%
    summarize(total = n()) %>%
    arrange(-total) %>%
    treemap(publisher_tm, index = "language",
                  vSize = "total",
                  fontsize.labels = 12,
                  palette = "YlOrRd",
            title = "The proportion of top 100 movie language",
              
                 
                       fontsize.title = 20)
```

## Number of top 9 languages between 2009 and 2019

```{r language_year,echo = FALSE,fig.cap="Number of top 9 languages between 2009 and 2019"}

top9 <- dat %>% 
  filter(year %in% c(2009:2019)) 
top_9_last <- head(names(sort(table(top9$language),decreasing = TRUE)),9) 


language_9 <- dat %>% 
  select (year,language) %>% 
  filter(language %in% top_9_last ,year %in% c(2009:2019)) %>% 
  group_by (year,language) %>%  
  count(language)

language_9 %>% 
  ggplot(aes(x= year, y= n))+
  geom_line()+
  facet_wrap(~ language,,scales = "free_y")+
  scale_x_continuous(breaks = seq(2009, 2019, by = 1))+
  theme(axis.text.x = element_text(angle=90, hjust=1, vjust=1)) +
  xlab("year")+
  ylab("Number of top 9 languages between 2009 and 2019")
```
#  Genres 

## The proportion of top 100 movie genres

```{r genres,echo = FALSE,fig.cap="The proportion of top 100 movie genres"}
top100_genre<- head(names(sort(table(dat$genre),decreasing = TRUE)),100) 
most_genre <- dat %>% 
    filter(genre %in% top100_genre) %>% 
    group_by(genre) %>%
    summarize(total = n()) %>%
    arrange(-total) %>%
    treemap(publisher_tm, index = "genre",
                  vSize = "total",
                  fontsize.labels = 12,
                  palette = "YlOrRd",
                  title="The proportion of top 100 movie genres",
                       fontsize.title = 20)
```
