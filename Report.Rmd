---
title: "5513 - Assignment 4"
author: "Aryan Jain"
output: 
  bookdown::pdf_document2
keep_md: True
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE)
```

```{r Loading dataset}
dat = read.csv("Data/IMDb movies.csv")
```

```{r}
library(tidyverse)
library(scales)
library(kableExtra)
```

## Director Analysis

#### Most Successful Director

Lets take a look at the some of the most successful directors from our dataset. Now, there are limitless ways to measure success but for our test, we're only looking at people with at least 4 movies under their belt and a Metascore upwards of 80. And conveniently, we get only 10 names.

```{r}
directors <- dat %>%
  group_by(director) %>%
  summarise(movies = n(),
            metascore = round(mean(metascore))) %>%
  filter(metascore > 80,
         movies > 3) %>%
  arrange(-metascore, -movies)
```

```{r dir_tab}
directors %>%
kable(col.names = c("Director",
                      "Total Movies",
                      "Metascore")) %>%
  kable_styling()
```

We get some interesting results, as on one hand there is Mike Leigh with as much as 13 movies but a lower average metascore. On the other hand, there are directors like Damien Chazelle and Patrick wang with 4 movies each and an average metascore of 87 and 86 respectively. 

```{r}
directors %>%
  ggplot(aes(x = director, y = movies, fill = metascore)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  xlab("") +
  ylab("No. of Movies")
```

#### Top Grossing Movie

In this section, we'll look at the top grossing movie of the most successful directors that we established from Table \@ref(tab:dir_tab).

```{r}
director_movie <- dat %>%
  right_join(directors, by = c("director" = "director")) %>%
  select(director, title, worlwide_gross_income)

director_movie$worlwide_gross_income = as.numeric(gsub("[\\$,]", "", director_movie$worlwide_gross_income))

director_movie_final <- director_movie %>% 
  group_by(director) %>%
  summarise(worlwide_gross_income = max(worlwide_gross_income, na.rm = TRUE)) %>%
  left_join(director_movie)

director_movie_final %>%
  select(director, title, worlwide_gross_income) %>%
  arrange(-worlwide_gross_income) %>%
  mutate(worlwide_gross_income = dollar(worlwide_gross_income)) %>%
  kable(col.names = c("Director",
                      "Highest Grossing Movie",
                      "Total Revenue")) %>%
  kable_styling()
```

It can be observed that the *Alfonso CuarÃ³n* is the director of the top grossing movie *Harry Potter and the Prisoner of Azkaban* which made \$796,093,802 worldwide. Followed by, *Damien Chazelle*, the director of *La La Land* grossing \$446,092,35. Suprisingly, *Patrick Wang*, with an average metascore of 86 and a total of 4 movies made the least at just \$101,934.

```{r fig.align="center"}
director_movie_final %>%
  mutate(director = fct_reorder(director, worlwide_gross_income)) %>%
  ggplot(aes(y = worlwide_gross_income, x = director, fill = title)) +
  geom_col() +
  theme(legend.position = "right", legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_y_continuous(label = comma) +
  xlab("") +
  ylab("")
```

## Movie Length and Language Analysis

```{r}
dat1 <- dat
dat1$language <- ifelse(str_detect(dat1$language, ","), "multi-lingual", dat1$language)
dat1$budget = as.numeric(gsub("[\\$,]", "", dat1$budget))
```

Let's look at some of the common movie languages.

```{r}
dat2 <- dat1 %>%
  count(language) %>%
  arrange(-n) %>%
  head(10)
```

```{r}
dat2 %>%
  kable(col.names = c("Language", "Number of Movies")) %>%
  kable_styling()
```

From the above table, it is quite clear that most movies are released in either only *English* or in *multi-lingual* format.

```{r}
dat3 <- dat1 %>%
  filter(language %in% dat2$language) %>%
  group_by(language) %>%
  summarise(duration = mean(duration, na.rm = TRUE))
```

#### Is there a pattern in Movie length for various languages?

```{r}
dat3 %>%
  kable(col.names = c("Language", "Avg. Movie Duration")) %>%
  kable_styling()
```

```{r fig.align="center"}
dat3 %>%
  ggplot(aes(x = language, y = duration, fill = language)) +
  geom_col() +
  ylab("Duration (in minutes)") +
  xlab("") + 
  theme(legend.position = "bottom", axis.text.x=element_blank())
```

From the plot above, we can infer that *Hindi* movies are usually much longer than other languages clocking at an average runtime of 140 minutes. While, *English* movies are usually the shortest at just 93 minutes.

## Conclusion

For Director analysis, it is clear from Figure 1 and Figure 2 that there is no one single way to measure success and that all directors in the list are doing very good in their own ways.

And from the Movie length analysis, we can infer that Hindi Movies are usually significantly longer than any other kind of movies. Also, english movies are among the shortest. We also concluded that movie language has an impact on movie length.
